<app-breadcrumb [path]="routes.PRODUCT"></app-breadcrumb>  
<mat-card class="product-info-wrapper">
  <div class="product-gallery">
    <img class="main-product-image" [src]="selectedImage || product?.image?.url" alt="product-main-image">
    
    <div class="thumbnail-wrapper" *ngIf="product?.image?.length > 0">
      <div class="thumbnail-list">
        <img 
          *ngFor="let img of product?.image; let i = index" 
          [src]="img?.url" 
          [alt]="'product-thumbnail-' + i"
          class="thumbnail"
          [class.active]="img?.url === selectedImage"
          (click)="selectImage(img?.url)">
      </div>
    </div>
    
    <div class="admin-image-actions">
      <button mat-raised-button color="primary" (click)="addImage()">
        <mat-icon>add_photo_alternate</mat-icon>
        افزودن تصویر
      </button>
      <button mat-raised-button color="warn" (click)="removeImage(selectedImage)" [disabled]="!selectedImage">
        <mat-icon>delete</mat-icon>
        حذف تصویر انتخابی
      </button>
    </div>
  </div>

  <div class="info-wrapper">
    <div class="info-header">
      <div class="info-inner-wrapper">
        <h1 class="product-title">{{product?.productName}}</h1>
        <p class="product-id">شناسه محصول: {{product?.id}}</p>
      </div>

      <div class="admin-status-badge">
        <mat-chip [color]="product?.status ? 'primary' : 'warn'" selected>
          {{product?.status ? 'فعال' : 'غیرفعال'}}
        </mat-chip>
        <mat-chip *ngIf="product?.active_discount" color="accent" selected>
          تخفیف فعال
        </mat-chip>
      </div>
    </div>

    <div class="price-stock-info">
      <div class="info-card">
        <h3>قیمت‌گذاری</h3>
        <div class="info-row">
          <span>کد محصول:</span>
          <strong>{{product?.productCode}}</strong>
        </div>
        <div class="info-row">
          <span>قیمت:</span>
          <strong class="final-price">{{product?.price | currency:'تومان'}}</strong>
        </div>
        <div class="info-row">
          <span>تخفیف:</span>
          <span>{{product?.active_discount ? 'دارد' : 'ندارد'}}</span>
        </div>
      </div>

      <div class="info-card">
        <h3>موجودی</h3>
        <div class="info-row">
          <span>موجودی انبار:</span>
          <strong [class.low-stock]="(product?.quantity || 0) < 10">{{product?.quantity || 0}} عدد</strong>
        </div>
        <div class="info-row">
          <span>اسلاگ:</span>
          <span>{{product?.slug}}</span>
        </div>
      </div>
    </div>

    <div class="admin-actions">
      <button mat-raised-button color="primary" (click)="editProduct()">
        <mat-icon>edit</mat-icon>
        ویرایش محصول
      </button>
      
      <button mat-raised-button color="accent" (click)="updateStock()">
        <mat-icon>inventory</mat-icon>
        بروزرسانی موجودی
      </button>
      
      <button mat-raised-button color="warn" (click)="toggleProductStatus()">
        <mat-icon>{{product?.status ? 'visibility_off' : 'visibility'}}</mat-icon>
        {{product?.status ? 'غیرفعال کردن' : 'فعال کردن'}}
      </button>
      
      <button mat-raised-button class="delete-btn" (click)="deleteProduct()">
        <mat-icon>delete_forever</mat-icon>
        حذف محصول
      </button>
    </div>

    <div class="technical-info">
      <div class="info-card">
        <h3>اطلاعات فنی</h3>
        <div class="info-row">
          <span>وضعیت:</span>
          <span>{{product?.status ? 'فعال' : 'غیرفعال'}}</span>
        </div>
        <div class="info-row">
          <span>تعداد تصاویر:</span>
          <span>{{product?.image?.length || 0}}</span>
        </div>
        <div class="info-row">
          <span>تعداد جزئیات:</span>
          <span>{{product?.details?.length || 0}}</span>
        </div>
      </div>

      <div class="info-card">
        <h3>آخرین تغییرات</h3>
        <div class="info-row">
          <span>آخرین ویرایش:</span>
          <span>سیستم مدیریتی</span>
        </div>
      </div>
    </div>
  </div>
</mat-card>

<mat-card class="product-details-tabs">
  <mat-tab-group>
    <mat-tab label="توضیحات">
      <div class="tab-content">
        <h3>توضیحات کامل محصول</h3>
        <div class="description-editor">
          {{product?.description || 'توضیحی برای این محصول ثبت نشده است.'}}
        </div>
        
        <div class="features-section" *ngIf="product?.details && product.details.length > 0">
          <h4>جزئیات محصول</h4>
          <ul>
            <li *ngFor="let detail of product?.details">
              <strong>{{detail.key}}:</strong> {{detail.value}}
            </li>
          </ul>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="تصاویر محصول">
      <div class="tab-content">
        <div class="image-management">
          <div class="upload-section">
            <h4>آپلود تصاویر جدید</h4>
            <input type="file" #fileInput multiple (change)="onFileSelected($event)" accept="image/*" hidden>
            <button mat-raised-button (click)="fileInput.click()">
              <mat-icon>cloud_upload</mat-icon>
              انتخاب فایل‌ها
            </button>
            <button mat-raised-button color="primary" (click)="uploadImages()" [disabled]="!selectedFiles.length">
              آپلود تصاویر
            </button>
          </div>
          
          <div class="images-list">
            <h4>تصاویر فعلی ({{product?.image?.length || 0}})</h4>
            <div class="images-grid">
              <div class="image-item" *ngFor="let img of product?.image; let i = index">
                <img [src]="img?.url" [alt]="'image-' + i">
                <div class="image-actions">
                  <button mat-icon-button color="primary" (click)="selectImage(img?.url)">
                    <mat-icon>visibility</mat-icon>
                  </button>
                  <button mat-icon-button color="warn" (click)="deleteImage(img?.url)">
                    <mat-icon>delete</mat-icon>
                  </button>
                </div>
                <span class="image-index">{{i + 1}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </mat-tab>

    <mat-tab label="جزئیات فنی">
      <div class="tab-content">
        <div class="specs-table" *ngIf="product?.details && product.details.length > 0">
          <div class="spec-row" *ngFor="let detail of product?.details">
            <span class="spec-title">{{detail.key}}:</span>
            <span class="spec-value">{{detail.value}}</span>
          </div>
        </div>
        <div *ngIf="!product?.details || product.details.length === 0" class="no-data">
          <mat-icon>info</mat-icon>
          <p>هیچ جزئیات فنی برای این محصول ثبت نشده است.</p>
        </div>
        
        <button mat-raised-button color="primary" (click)="editSpecifications()">
          ویرایش جزئیات فنی
        </button>
      </div>
    </mat-tab>
  </mat-tab-group>
</mat-card> -->
